import{c as G,u as H,r as D,e as O,o as Y,m as y,aO as B,at as Z,g as L,h as i,w as c,i as t,I as q,j as o,k as s,z as d,l as r,aL as J,a$ as K,a4 as N,p as Q,t as m,A as f,x as P,y as u,C as U,F as W,D as X,aa as tt,E as st,G as et,ax as at,a8 as ot,S as nt,a3 as R,Y as lt,v as it,aZ as ct,_ as rt}from"./index-C9U6OB9Y.js";const dt={class:"daily-page"},ut={class:"daily-hero"},_t={class:"top-bar"},mt={class:"top-actions"},pt={class:"hero-content"},ht={class:"daily-icon"},gt={class:"date"},vt={class:"hero-actions"},yt={class:"content-section"},ft={key:0,class:"loading-container"},kt={key:1,class:"songs-list"},xt=["onClick"],Ct={class:"song-index"},St={key:0},bt={class:"song-main"},wt={class:"song-cover"},It=["src","alt"],Dt={class:"song-info"},Ot={class:"song-name s-text-truncate"},Bt={class:"song-meta s-text-secondary s-text-truncate"},Lt={key:0},Nt={class:"song-actions"},Pt={key:2,class:"empty-state"},Rt=G({__name:"index",setup(Vt){const k=et(),_=H(),l=D([]),v=D(!1),x=O(()=>_.currentSong),V=O(()=>new Date().getDate());Y(()=>{C()});const C=async()=>{v.value=!0;try{try{const n=await y.getDailyRecommendSongs();l.value=n.data.dailySongs.map(B)}catch{console.log("获取每日推荐失败，使用默认歌单");const e=await y.getPlaylistDetail(3778678),a=await y.getPlaylistTracks(3778678,30);l.value=a.songs.map(B)}}catch(n){console.error("加载每日推荐失败:",n),p("加载失败，请稍后重试")}finally{v.value=!1}},j=()=>{k.back()},z=()=>{C(),p("已刷新推荐内容")},A=()=>{console.log("更多操作")},E=()=>{l.value.length>0&&_.setPlaylist(l.value,0)},S=(n,e)=>{_.setPlaylist(l.value,e)},M=n=>{_.toggleLike(n)},T=async n=>{await(await ct.create({header:n.name,buttons:[{text:"立即播放",icon:P,handler:()=>{const a=l.value.findIndex(h=>h.id===n.id);S(n,a)}},{text:"下一首播放",handler:()=>{p("已添加到下一首播放")}},{text:"添加到歌单",handler:()=>{p("功能开发中")}},{text:"分享",handler:()=>{p("功能开发中")}},{text:"取消",role:"cancel"}]})).present()},$=()=>{k.push("/login")},F=n=>{const e=n.target;e.src="/images/album.jpg"},p=async n=>{await(await Z.create({message:n,duration:2e3,position:"bottom"})).present()};return(n,e)=>(i(),L(t(q),null,{default:c(()=>[o(t(st),{fullscreen:!0,class:"daily-content"},{default:c(()=>[s("div",dt,[s("div",ut,[e[1]||(e[1]=s("div",{class:"hero-overlay"},null,-1)),s("div",_t,[o(t(d),{fill:"clear",color:"light",onClick:j,class:"back-button"},{default:c(()=>[o(t(r),{icon:t(J)},null,8,["icon"])]),_:1}),s("div",mt,[o(t(d),{fill:"clear",color:"light",onClick:z},{default:c(()=>[o(t(r),{icon:t(K)},null,8,["icon"])]),_:1}),o(t(d),{fill:"clear",color:"light",onClick:A},{default:c(()=>[o(t(r),{icon:t(N)},null,8,["icon"])]),_:1})])]),s("div",pt,[s("div",ht,[o(t(r),{icon:t(Q)},null,8,["icon"]),s("span",gt,m(V.value),1)]),e[0]||(e[0]=s("div",{class:"daily-info"},[s("h1",{class:"daily-title"},"每日推荐"),s("p",{class:"daily-subtitle"},"根据你的音乐品味精心挑选")],-1))]),s("div",vt,[o(t(d),{expand:"block",class:"play-all-button",onClick:E,disabled:!l.value.length},{default:c(()=>[o(t(r),{icon:t(P),slot:"start"},null,8,["icon"]),f(" 播放全部 ("+m(l.value.length)+") ",1)]),_:1},8,["disabled"])])]),s("div",yt,[v.value?(i(),u("div",ft,[o(t(U),{name:"circular"}),e[2]||(e[2]=s("p",null,"正在为你精选音乐...",-1))])):l.value.length>0?(i(),u("div",kt,[(i(!0),u(W,null,X(l.value,(a,h)=>{var b,w,I;return i(),u("div",{key:a.id,class:at(["song-item",{playing:((b=x.value)==null?void 0:b.id)===a.id}]),onClick:g=>S(a,h)},[s("div",Ct,[((w=x.value)==null?void 0:w.id)!==a.id?(i(),u("span",St,m(h+1),1)):(i(),L(t(r),{key:1,icon:t(ot),color:"primary"},null,8,["icon"]))]),s("div",bt,[s("div",wt,[s("img",{src:a.cover||"/images/album.jpg",alt:a.name,onError:F},null,40,It)]),s("div",Dt,[s("h3",Ot,m(a.name),1),s("p",Bt,[f(m((I=a.artists)==null?void 0:I.map(g=>g.name).join(", "))+" ",1),a.album?(i(),u("span",Lt," - "+m(a.album.name),1)):nt("",!0)])])]),s("div",Nt,[o(t(d),{fill:"clear",size:"small",onClick:R(g=>M(a.id),["stop"]),color:t(_).isLiked(a.id)?"primary":"medium"},{default:c(()=>[o(t(r),{icon:t(_).isLiked(a.id)?t(lt):t(it)},null,8,["icon"])]),_:2},1032,["onClick","color"]),o(t(d),{fill:"clear",size:"small",onClick:R(g=>T(a),["stop"])},{default:c(()=>[o(t(r),{icon:t(N)},null,8,["icon"])]),_:1},8,["onClick"])])],10,xt)}),128))])):(i(),u("div",Pt,[o(t(r),{icon:t(tt),class:"empty-icon"},null,8,["icon"]),e[4]||(e[4]=s("h3",null,"暂无推荐",-1)),e[5]||(e[5]=s("p",null,"请先登录以获取个性化推荐",-1)),o(t(d),{onClick:$},{default:c(()=>[...e[3]||(e[3]=[f("立即登录",-1)])]),_:1})]))])])]),_:1})]),_:1}))}}),zt=rt(Rt,[["__scopeId","data-v-68b7206d"]]);export{zt as default};
//# sourceMappingURL=index-B4XSCNa2.js.map
