import{c as H,r as g,e as J,g as m,h as p,w as s,i as l,I as K,j as a,J as X,L as Y,aT as Z,K as ee,A as n,M as le,k as r,a3 as ae,y as _,a1 as oe,a2 as Q,X as f,S as y,a7 as I,b0 as V,ax as C,b1 as x,t as b,z as h,l as B,b2 as T,b3 as W,aS as se,C as te,b4 as re,E as ne,at as ue,G as de,_ as ie}from"./index-C9U6OB9Y.js";import{u as pe}from"./user-C-PeXwOA.js";const ve={class:"login-container"},fe={key:0,class:"form-fields"},me={class:"captcha-option"},ce={key:1,class:"form-fields"},we={key:1},ge={class:"third-party-login"},he={class:"social-buttons"},Ee=H({__name:"index",setup(ke){const z=de(),E=pe(),v=g("phone"),c=g(!1),k=g(!1),w=g(0),o=g({phone:"",password:"",captcha:"",phoneError:"",passwordError:""}),t=g({email:"",password:"",emailError:"",passwordError:""}),{loginLoading:P}=E,M=J(()=>v.value==="phone"?o.value.phone&&o.value.password&&!o.value.phoneError&&!o.value.passwordError&&(!k.value||o.value.captcha):t.value.email&&t.value.password&&!t.value.emailError&&!t.value.passwordError),N=()=>{const u=o.value.phone;u?/^1[3-9]\d{9}$/.test(u)?o.value.phoneError="":o.value.phoneError="请输入正确的手机号":o.value.phoneError="请输入手机号"},q=()=>{const u=t.value.email;u?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?t.value.emailError="":t.value.emailError="请输入正确的邮箱格式":t.value.emailError="请输入邮箱"},S=()=>{const u=v.value==="phone"?o.value.password:t.value.password;if(u)if(u.length<6){const e="密码长度不能少于6位";v.value==="phone"?o.value.passwordError=e:t.value.passwordError=e}else v.value==="phone"?o.value.passwordError="":t.value.passwordError="";else{const e="请输入密码";v.value==="phone"?o.value.passwordError=e:t.value.passwordError=e}},U=()=>{c.value=!c.value},L=async()=>{if(!o.value.phone){i("请先输入手机号");return}try{await E.sendCaptcha(o.value.phone),i("验证码已发送"),F()}catch{i("发送失败，请重试")}},F=()=>{w.value=60;const u=setInterval(()=>{w.value--,w.value<=0&&clearInterval(u)},1e3)},O=async()=>{try{v.value==="phone"?k.value?await E.loginWithPhone(o.value.phone,o.value.password,o.value.captcha):await E.loginWithPhone(o.value.phone,o.value.password):await E.loginWithEmail(t.value.email,t.value.password),i("登录成功"),z.push("/tabs/my")}catch(u){i(u instanceof Error?u.message:"登录失败")}},$=()=>{i("功能开发中")},R=()=>{i("功能开发中")},j=()=>{i("微信登录功能开发中")},A=()=>{i("QQ登录功能开发中")},D=()=>{i("用户协议功能开发中")},G=()=>{i("隐私政策功能开发中")},i=async u=>{await(await ue.create({message:u,duration:2e3,position:"bottom"})).present()};return(u,e)=>(p(),m(l(K),null,{default:s(()=>[a(l(le),null,{default:s(()=>[a(l(X),null,{default:s(()=>[a(l(Y),{slot:"start"},{default:s(()=>[a(l(Z),{"default-href":"/tabs/my"})]),_:1}),a(l(ee),null,{default:s(()=>[...e[7]||(e[7]=[n("登录",-1)])]),_:1})]),_:1})]),_:1}),a(l(ne),{class:"login-content"},{default:s(()=>[r("div",ve,[e[23]||(e[23]=r("div",{class:"logo-section"},[r("h1",{class:"app-name"},"SPlayer"),r("p",{class:"app-slogan"},"发现好音乐，享受好时光")],-1)),r("form",{onSubmit:ae(O,["prevent"]),class:"login-form"},[a(l(oe),{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=d=>v.value=d),class:"login-method"},{default:s(()=>[a(l(Q),{value:"phone"},{default:s(()=>[a(l(f),null,{default:s(()=>[...e[8]||(e[8]=[n("手机号登录",-1)])]),_:1})]),_:1}),a(l(Q),{value:"email"},{default:s(()=>[a(l(f),null,{default:s(()=>[...e[9]||(e[9]=[n("邮箱登录",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),v.value==="phone"?(p(),_("div",fe,[a(l(I),null,{default:s(()=>[a(l(f),{position:"stacked"},{default:s(()=>[...e[10]||(e[10]=[n("手机号",-1)])]),_:1}),a(l(V),{modelValue:o.value.phone,"onUpdate:modelValue":e[1]||(e[1]=d=>o.value.phone=d),type:"tel",placeholder:"请输入手机号",class:C({"ion-invalid":o.value.phoneError}),onIonBlur:N,required:""},null,8,["modelValue","class"]),o.value.phoneError?(p(),m(l(x),{key:0,slot:"error"},{default:s(()=>[n(b(o.value.phoneError),1)]),_:1})):y("",!0)]),_:1}),a(l(I),null,{default:s(()=>[a(l(f),{position:"stacked"},{default:s(()=>[...e[11]||(e[11]=[n("密码",-1)])]),_:1}),a(l(V),{modelValue:o.value.password,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value.password=d),type:c.value?"text":"password",placeholder:"请输入密码",class:C({"ion-invalid":o.value.passwordError}),onIonBlur:S,required:""},null,8,["modelValue","type","class"]),a(l(h),{slot:"end",fill:"clear",onClick:U},{default:s(()=>[a(l(B),{icon:c.value?l(T):l(W)},null,8,["icon"])]),_:1}),o.value.passwordError?(p(),m(l(x),{key:0,slot:"error"},{default:s(()=>[n(b(o.value.passwordError),1)]),_:1})):y("",!0)]),_:1}),r("div",me,[a(l(se),{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=d=>k.value=d)},null,8,["modelValue"]),a(l(f),{class:"captcha-label"},{default:s(()=>[...e[12]||(e[12]=[n("使用短信验证码登录",-1)])]),_:1})]),k.value?(p(),m(l(I),{key:0},{default:s(()=>[a(l(f),{position:"stacked"},{default:s(()=>[...e[13]||(e[13]=[n("验证码",-1)])]),_:1}),a(l(V),{modelValue:o.value.captcha,"onUpdate:modelValue":e[4]||(e[4]=d=>o.value.captcha=d),type:"text",placeholder:"请输入验证码",maxlength:6},null,8,["modelValue"]),a(l(h),{slot:"end",size:"small",fill:"outline",disabled:!o.value.phone||w.value>0,onClick:L},{default:s(()=>[n(b(w.value>0?`${w.value}s`:"发送验证码"),1)]),_:1},8,["disabled"])]),_:1})):y("",!0)])):(p(),_("div",ce,[a(l(I),null,{default:s(()=>[a(l(f),{position:"stacked"},{default:s(()=>[...e[14]||(e[14]=[n("邮箱",-1)])]),_:1}),a(l(V),{modelValue:t.value.email,"onUpdate:modelValue":e[5]||(e[5]=d=>t.value.email=d),type:"email",placeholder:"请输入邮箱",class:C({"ion-invalid":t.value.emailError}),onIonBlur:q,required:""},null,8,["modelValue","class"]),t.value.emailError?(p(),m(l(x),{key:0,slot:"error"},{default:s(()=>[n(b(t.value.emailError),1)]),_:1})):y("",!0)]),_:1}),a(l(I),null,{default:s(()=>[a(l(f),{position:"stacked"},{default:s(()=>[...e[15]||(e[15]=[n("密码",-1)])]),_:1}),a(l(V),{modelValue:t.value.password,"onUpdate:modelValue":e[6]||(e[6]=d=>t.value.password=d),type:c.value?"text":"password",placeholder:"请输入密码",class:C({"ion-invalid":t.value.passwordError}),onIonBlur:S,required:""},null,8,["modelValue","type","class"]),a(l(h),{slot:"end",fill:"clear",onClick:U},{default:s(()=>[a(l(B),{icon:c.value?l(T):l(W)},null,8,["icon"])]),_:1}),t.value.passwordError?(p(),m(l(x),{key:0,slot:"error"},{default:s(()=>[n(b(t.value.passwordError),1)]),_:1})):y("",!0)]),_:1})])),a(l(h),{type:"submit",expand:"block",class:"login-button",disabled:!M.value||l(P)},{default:s(()=>[l(P)?(p(),m(l(te),{key:0,name:"crescent"})):(p(),_("span",we,"登录"))]),_:1},8,["disabled"])],32),r("div",{class:"login-options"},[r("div",{class:"forgot-password"},[r("a",{href:"#",onClick:$},"忘记密码？")]),r("div",{class:"register-link"},[e[16]||(e[16]=r("span",null,"还没有账号？",-1)),r("a",{href:"#",onClick:R},"立即注册")])]),r("div",ge,[e[20]||(e[20]=r("div",{class:"divider"},[r("span",null,"其他登录方式")],-1)),r("div",he,[a(l(h),{fill:"outline",size:"large",onClick:j},{default:s(()=>[a(l(B),{icon:l(re),slot:"start"},null,8,["icon"]),e[17]||(e[17]=n(" 微信登录 ",-1))]),_:1}),a(l(h),{fill:"outline",size:"large",onClick:A},{default:s(()=>[a(l(B),{slot:"start"},{default:s(()=>[...e[18]||(e[18]=[n("Q",-1)])]),_:1}),e[19]||(e[19]=n(" QQ登录 ",-1))]),_:1})])]),r("div",{class:"terms"},[r("p",null,[e[21]||(e[21]=n(" 登录即表示同意 ",-1)),r("a",{href:"#",onClick:D},"用户协议"),e[22]||(e[22]=n(" 和 ",-1)),r("a",{href:"#",onClick:G},"隐私政策")])])])]),_:1})]),_:1}))}}),Ve=ie(Ee,[["__scopeId","data-v-d485145b"]]);export{Ve as default};
//# sourceMappingURL=index-Dh8IksBa.js.map
