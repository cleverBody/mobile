import{d as ks,r as x,m as F,c as Cs,u as ws,e as Ss,o as xs,aP as Is,g as ns,h as c,w as p,i as t,I as Vs,j as a,k as o,H as Ts,z as A,l as _,aL as zs,az as es,a4 as as,y as d,S as N,a_ as Bs,t as g,A as C,x as O,Y as is,v as rs,ad as Us,a1 as Fs,a2 as $,X as E,C as Os,F as M,D as P,O as Ls,a8 as cs,aa as Ns,E as $s,G as Es,at as Ms,ax as Ps,a3 as us,aZ as Rs,_ as js}from"./index-C9U6OB9Y.js";const qs=s=>{if(!s)return{};const u=r=>r?typeof r=="string"?[{id:0,name:r,avatar:""}]:(Array.isArray(r)?r:[r]).map(i=>({id:(i==null?void 0:i.id)||0,name:(i==null?void 0:i.name)||i||"未知艺术家",avatar:(i==null?void 0:i.img1v1Url)||(i==null?void 0:i.picUrl)||(i==null?void 0:i.avatar)||""})):[],h=r=>{if(r)return typeof r=="string"?{id:0,name:r,cover:""}:{id:r.id||0,name:r.name||"未知专辑",cover:r.picUrl||r.cover||""}};return{id:s.id||0,name:s.name||"未知歌曲",artists:u(s.ar||s.artists||s.artist),album:h(s.al||s.album),duration:Number(s.dt||s.duration||0),cover:j(s),url:s.url,lyric:s.lyric}},R=s=>{var u,h;return s?{id:s.id||0,name:s.name||"未知艺术家",cover:j(s),description:s.description||s.briefDesc||"",followers:s.followeds||s.followers||0,songsCount:s.musicSize||s.songsCount||0,albumsCount:s.albumSize||s.albumsCount||0,mvCount:s.mvSize||s.mvCount||0,isFollowed:s.followed||!1,alias:((u=s.alias)==null?void 0:u[0])||"",identify:((h=s.identifyTag)==null?void 0:h[0])||s.identify}:null},Hs=s=>{var u;return s?{id:s.id||0,name:s.name||"未知专辑",cover:j(s),publishTime:s.publishTime?ds(s.publishTime):"",songsCount:s.size||s.trackCount||0,description:s.description||s.briefDesc||"",artist:R(s.artist||((u=s.artists)==null?void 0:u[0]))}:null},Gs=s=>s?{id:s.id||0,name:s.name||"未知视频",cover:s.imgurl||s.cover||s.picUrl||"",duration:s.duration||0,playCount:s.playCount||0,publishTime:s.publishTime?ds(s.publishTime):"",artists:Xs(s.artists||s.artist||[])}:null,Xs=s=>s?(Array.isArray(s)?s:[s]).map(R).filter(Boolean):[],j=s=>{var h;const u=s.cover||s.picUrl||s.coverUrl||s.coverImgUrl||s.imgurl||s.img1v1Url||((h=s.album||s.al)==null?void 0:h.picUrl)||"";return u?u.replace(/^http:/,"https:"):""},ds=s=>s?new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"",Ys=ks("artist",()=>{const s=x(null),u=x([]),h=x([]),r=x([]),y=x([]),i=x(!1);return{currentArtist:s,artistSongs:u,artistAlbums:h,artistVideos:r,similarArtists:y,loading:i,loadArtist:async m=>{if(!i.value){i.value=!0;try{const f=await F.getArtistDetail(m),k=f.artist||f;s.value=R(k);const z=await F.getArtistTopSongs(m),L=z.hotSongs||z.songs||[];u.value=L.map(qs),console.log("歌手信息加载完成:",s.value.name)}catch(f){console.error("加载歌手信息失败:",f)}finally{i.value=!1}}},loadArtistAlbums:async m=>{try{const f=await F.getArtistAlbums(m),k=f.hotAlbums||f.albums||[];h.value=k.map(Hs).filter(Boolean)}catch(f){console.error("加载歌手专辑失败:",f)}},loadArtistVideos:async m=>{try{const f=await F.getArtistVideos(m),k=f.mvs||f.videos||[];r.value=k.map(Gs).filter(Boolean)}catch(f){console.error("加载歌手视频失败:",f)}},followArtist:async m=>{console.log("关注歌手:",m)},unfollowArtist:async m=>{console.log("取消关注歌手:",m)},clearArtist:()=>{s.value=null,u.value=[],h.value=[],r.value=[],y.value=[]}}}),Zs={class:"artist-page"},Js={class:"top-bar"},Ks={class:"top-actions"},Qs={class:"hero-content"},Ws={class:"artist-avatar-container"},Ds={class:"artist-avatar"},st=["src","alt"],tt={key:0,class:"verified-badge"},ot={class:"artist-info"},lt={class:"artist-title"},nt={class:"artist-stats"},et={key:0,class:"artist-description"},at={class:"hero-actions"},it={class:"action-row"},rt={class:"content-section"},ct={class:"section-tabs"},ut={key:0,class:"loading-container"},dt={key:1,class:"songs-list"},vt=["onClick"],ft={class:"song-index"},pt={key:0},gt={class:"song-main"},_t={class:"song-cover"},ht=["src","alt"],mt={class:"song-info"},yt={class:"song-name s-text-truncate"},bt={class:"song-meta s-text-secondary s-text-truncate"},At={key:0},kt={class:"song-actions"},Ct={key:2,class:"albums-section"},wt={key:0,class:"albums-grid"},St=["onClick"],xt={class:"album-cover"},It=["src","alt"],Vt={class:"album-overlay"},Tt={class:"album-info"},zt={key:1,class:"empty-state"},Bt={key:3,class:"videos-section"},Ut={key:0,class:"videos-grid"},Ft=["onClick"],Ot={class:"video-cover"},Lt=["src","alt"],Nt={class:"video-overlay"},$t={class:"video-duration"},Et={class:"video-info"},Mt={key:1,class:"empty-state"},Pt={key:4,class:"empty-state"},Rt=Cs({__name:"index",setup(s){const u=Is(),h=Es(),r=Ys(),y=ws(),i=x("songs"),{currentArtist:v,artistSongs:b,artistAlbums:V,artistVideos:T,similarArtists:vs,loading:q}=r,m=Ss(()=>y.currentSong);xs(()=>{const n=parseInt(u.query.id);n&&(r.loadArtist(n),i.value==="albums"?r.loadArtistAlbums(n):i.value==="videos"&&r.loadArtistVideos(n))});const f=n=>n?n>=1e8?(n/1e8).toFixed(1)+"亿":n>=1e4?(n/1e4).toFixed(1)+"万":n.toString():"0",k=n=>{if(!n)return"00:00";const l=Math.floor(n/6e4),I=Math.floor(n%6e4/1e3);return`${l.toString().padStart(2,"0")}:${I.toString().padStart(2,"0")}`},z=n=>f(n),L=()=>{h.back()},H=()=>{console.log("分享艺术家")},fs=()=>{console.log("更多操作")},ps=async()=>{if(v.value)try{v.value.isFollowed?(await r.unfollowArtist(v.value.id),w("已取消关注")):(await r.followArtist(v.value.id),w("关注成功"))}catch{w("操作失败")}},gs=()=>{b.value.length>0&&y.setPlaylist(b.value,0)},_s=()=>{if(b.value.length>0){const n=[...b.value].sort(()=>Math.random()-.5);y.setPlaylist(n,0),w("开始随机播放")}},G=(n,l)=>{y.setPlaylist(b.value,l)},hs=n=>{y.toggleLike(n)},ms=async n=>{await(await Rs.create({header:n.name,buttons:[{text:"立即播放",icon:O,handler:()=>{const I=b.value.findIndex(U=>U.id===n.id);G(n,I)}},{text:"下一首播放",handler:()=>{w("已添加到下一首播放")}},{text:"添加到歌单",handler:()=>{w("功能开发中")}},{text:"分享",handler:()=>{w("功能开发中")}},{text:"取消",role:"cancel"}]})).present()},ys=n=>{i.value=n.detail.value;const l=parseInt(u.query.id);l&&(i.value==="albums"&&V.value.length===0?r.loadArtistAlbums(l):i.value==="videos"&&T.value.length===0&&r.loadArtistVideos(l))},B=n=>{const l=n.target;l.src="/images/default-avatar.jpg"},bs=n=>{h.push({name:"Album",params:{id:n}})},As=n=>{console.log("播放视频:",n)},w=async n=>{await(await Ms.create({message:n,duration:2e3,position:"bottom"})).present()};return(n,l)=>(c(),ns(t(Vs),null,{default:p(()=>[a(t($s),{fullscreen:!0,class:"artist-content"},{default:p(()=>{var I,U,X,Y,Z,J,K,Q,W;return[o("div",Zs,[o("div",{class:"artist-hero",style:Ts({backgroundImage:`url(${((I=t(v))==null?void 0:I.cover)||"/images/artist-bg.jpg"})`})},[l[6]||(l[6]=o("div",{class:"hero-overlay"},null,-1)),o("div",Js,[a(t(A),{fill:"clear",color:"light",onClick:L,class:"back-button"},{default:p(()=>[a(t(_),{icon:t(zs)},null,8,["icon"])]),_:1}),o("div",Ks,[a(t(A),{fill:"clear",color:"light",onClick:H},{default:p(()=>[a(t(_),{icon:t(es)},null,8,["icon"])]),_:1}),a(t(A),{fill:"clear",color:"light",onClick:fs},{default:p(()=>[a(t(_),{icon:t(as)},null,8,["icon"])]),_:1})])]),o("div",Qs,[o("div",Ws,[o("div",Ds,[o("img",{src:((U=t(v))==null?void 0:U.cover)||"/images/default-avatar.jpg",alt:(X=t(v))==null?void 0:X.name,onError:B},null,40,st),(Y=t(v))!=null&&Y.isFollowed?(c(),d("div",tt,[a(t(_),{icon:t(Bs)},null,8,["icon"])])):N("",!0)])]),o("div",ot,[o("h1",lt,g(((Z=t(v))==null?void 0:Z.name)||"加载中..."),1),o("div",nt,[o("span",null,g(f((J=t(v))==null?void 0:J.followers))+"粉丝",1),l[1]||(l[1]=o("span",{class:"separator"},"•",-1)),o("span",null,g(((K=t(v))==null?void 0:K.songsCount)||0)+"首歌",1),l[2]||(l[2]=o("span",{class:"separator"},"•",-1)),o("span",null,g(((Q=t(v))==null?void 0:Q.albumsCount)||0)+"张专辑",1)]),(W=t(v))!=null&&W.description?(c(),d("p",et,g(t(v).description),1)):N("",!0)])]),o("div",at,[a(t(A),{expand:"block",class:"play-all-button",onClick:gs,disabled:!t(b).length},{default:p(()=>[a(t(_),{icon:t(O),slot:"start"},null,8,["icon"]),l[3]||(l[3]=C(" 播放全部 ",-1))]),_:1},8,["disabled"]),o("div",it,[a(t(A),{fill:"clear",color:"light",onClick:ps},{default:p(()=>{var e,S;return[a(t(_),{icon:(e=t(v))!=null&&e.isFollowed?t(is):t(rs)},null,8,["icon"]),C(" "+g((S=t(v))!=null&&S.isFollowed?"已关注":"关注"),1)]}),_:1},8,["color"]),a(t(A),{fill:"clear",color:"light",onClick:_s},{default:p(()=>[a(t(_),{icon:t(Us)},null,8,["icon"]),l[4]||(l[4]=C(" 随机播放 ",-1))]),_:1}),a(t(A),{fill:"clear",color:"light",onClick:H},{default:p(()=>[a(t(_),{icon:t(es)},null,8,["icon"]),l[5]||(l[5]=C(" 分享 ",-1))]),_:1})])])],4),o("div",rt,[o("div",ct,[a(t(Fs),{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),onIonChange:ys},{default:p(()=>[a(t($),{value:"songs"},{default:p(()=>[a(t(E),null,{default:p(()=>[...l[7]||(l[7]=[C("单曲",-1)])]),_:1})]),_:1}),a(t($),{value:"albums"},{default:p(()=>[a(t(E),null,{default:p(()=>[...l[8]||(l[8]=[C("专辑",-1)])]),_:1})]),_:1}),a(t($),{value:"videos"},{default:p(()=>[a(t(E),null,{default:p(()=>[...l[9]||(l[9]=[C("视频",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(q)?(c(),d("div",ut,[a(t(Os),{name:"circular"}),l[10]||(l[10]=o("p",null,"加载中...",-1))])):i.value==="songs"&&t(b).length>0?(c(),d("div",dt,[(c(!0),d(M,null,P(t(b),(e,S)=>{var D,ss,ts,os;return c(),d("div",{key:e.id,class:Ps(["song-item",{playing:((D=m.value)==null?void 0:D.id)===e.id}]),onClick:ls=>G(e,S)},[o("div",ft,[((ss=m.value)==null?void 0:ss.id)!==e.id?(c(),d("span",pt,g(S+1),1)):(c(),ns(t(_),{key:1,icon:t(cs),color:"primary"},null,8,["icon"]))]),o("div",gt,[o("div",_t,[o("img",{src:e.cover||((ts=t(v))==null?void 0:ts.cover)||"/images/album.jpg",alt:e.name,onError:B},null,40,ht)]),o("div",mt,[o("h3",yt,g(e.name),1),o("p",bt,[C(g((os=e.album)==null?void 0:os.name)+" • "+g(k(e.duration))+" ",1),e.playCount?(c(),d("span",At," • "+g(z(e.playCount))+"次播放",1)):N("",!0)])])]),o("div",kt,[a(t(A),{fill:"clear",size:"small",onClick:us(ls=>hs(e.id),["stop"]),color:t(y).isLiked(e.id)?"primary":"medium"},{default:p(()=>[a(t(_),{icon:t(y).isLiked(e.id)?t(is):t(rs)},null,8,["icon"])]),_:2},1032,["onClick","color"]),a(t(A),{fill:"clear",size:"small",onClick:us(ls=>ms(e),["stop"])},{default:p(()=>[a(t(_),{icon:t(as)},null,8,["icon"])]),_:1},8,["onClick"])])],10,vt)}),128))])):i.value==="albums"?(c(),d("div",Ct,[t(V).length>0?(c(),d("div",wt,[(c(!0),d(M,null,P(t(V),e=>(c(),d("div",{key:e.id,class:"album-item",onClick:S=>bs(e.id)},[o("div",xt,[o("img",{src:e.cover,alt:e.name,onError:B},null,40,It),o("div",Vt,[a(t(_),{icon:t(O)},null,8,["icon"])])]),o("div",Tt,[o("h4",null,g(e.name),1),o("p",null,g(e.publishTime)+" · "+g(e.songsCount)+"首",1)])],8,St))),128))])):(c(),d("div",zt,[a(t(_),{icon:t(Ls),class:"empty-icon"},null,8,["icon"]),l[11]||(l[11]=o("h3",null,"暂无专辑",-1)),l[12]||(l[12]=o("p",null,"该艺术家暂时没有专辑",-1))]))])):i.value==="videos"?(c(),d("div",Bt,[t(T).length>0?(c(),d("div",Ut,[(c(!0),d(M,null,P(t(T),e=>(c(),d("div",{key:e.id,class:"video-item",onClick:S=>As(e.id)},[o("div",Ot,[o("img",{src:e.cover,alt:e.name,onError:B},null,40,Lt),o("div",Nt,[a(t(_),{icon:t(O)},null,8,["icon"])]),o("div",$t,g(k(e.duration)),1)]),o("div",Et,[o("h4",null,g(e.name),1),o("p",null,g(f(e.playCount))+"次播放 · "+g(e.publishTime),1)])],8,Ft))),128))])):(c(),d("div",Mt,[a(t(_),{icon:t(cs),class:"empty-icon"},null,8,["icon"]),l[13]||(l[13]=o("h3",null,"暂无视频",-1)),l[14]||(l[14]=o("p",null,"该艺术家暂时没有视频",-1))]))])):(c(),d("div",Pt,[a(t(_),{icon:t(Ns),class:"empty-icon"},null,8,["icon"]),l[15]||(l[15]=o("h3",null,"暂无内容",-1)),l[16]||(l[16]=o("p",null,"该艺术家暂时没有相关内容",-1))]))])])]}),_:1})]),_:1}))}}),qt=js(Rt,[["__scopeId","data-v-b920da5d"]]);export{qt as default};
//# sourceMappingURL=index-RP_q46UC.js.map
